{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {"url": "https://raw.githubusercontent.com/slim0090/FIT3179-Data-Visualisation-2/main/data/final_world_population.csv"},
    "width": 500,
    "height": 300,
    "transform": [
          {"filter": "datum['Country'] == 'China' || datum['Country'] == 'India' || datum['Country'] == 'United States of America' || datum['Country'] == 'Russia' || datum['Country'] == 'Indonesia'|| datum['Country'] == 'Malaysia'"}
        ],
    "encoding": {
        "x": {  "field": "Year",
                "type": "ordinal" ,
                "sort": ["1970","1980","1990","2000","2010","2015","2020","2022"] ,
                "axis": { "labelAngle": 0 , "labelFontSize": 12 , "titleFontSize": 14}
                } ,
        "y": {  "field": "Population",
                "type": "quantitative",
                "sort": "ascending"
                }
        },
    "layer": [
        {
            "mark": {"type": "line", "interpolate": "monotone" },
            "encoding": {
                "color": { "field": "Country" } ,
            "size":{
                "value": 1
            }
            }
        },
        {
            "mark": {"type" :"tick", "thickness": 5 },
            "encoding": {
                "color": {
                "field": "Country"
            },
            "tooltip": [
                {"field": "Country", "type": "nominal", "title": "Country"},
                {"field": "Population", "type": "quantitative"},
                {"field": "Year", "type": "ordinal"}
            
        ]
            }
    
        },
        {
            "transform": [
              {"filter": "datum.Population > 1425000000"},
              {
                "calculate": "'In ' + datum['Year'] + ', ' + datum['Country'] + ' has the highest ;Population of all time: ' + datum['Population']",
                "as": "text_annotation_raw"
              },
              {
                "calculate": "split(datum.text_annotation_raw, ';')",
                "as": "text_annotation"
              }
            ],
            "mark": {
              "type": "text",
              "align": "right",
              "dx": 25,
              "dy": -25,
              "baseline": "middle",
              "fontStyle": "italic"
            },
            "encoding": {"text": {"field": "text_annotation"}}
          }
    ]

}